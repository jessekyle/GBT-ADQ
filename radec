#! /usr/bin/python

import subprocess
from string import Template

RA = subprocess.check_output("/home/jkyle/GBT-ADQ/mysql/show_mysql_ra")
#print(float(RA[0:8].strip("\n")))

DEC = subprocess.check_output("/home/jkyle/GBT-ADQ/mysql/show_mysql_dec")
#print(float(DEC[0:8].strip("\n")))

SOURCE = subprocess.check_output("/home/jkyle/GBT-ADQ/mysql/show_mysql_source")
#print(SOURCE.strip("\n"))

html='''\
<html>
<head>
<!--[if lt IE 9]><script src="excanvas.js" type="text/javascript"></script><![endif]-->
<script src="jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="virtualsky.js" type="text/javascript"></script>
<script type="text/javascript">
 $(document).ready(function() {

       	var planetarium = $.virtualsky({
       	id: 'starmap',
       	projection: 'polar',
       	latitude: 38.433056,
       	longitude: -79.839722,
       	ground: true,
       	meteorshowers: true,
       	showorbits: false,
       	ecliptic: true,
       	meridian: true,
       	showgalaxy: true,
       	live: true
 });
      	planetarium.addPointer({
        'ra':$ra,
        'dec':$dec,
       	'label':'$source',
       	'url':'http://simbad.u-strasbg.fr/simbad/sim-id?Ident=$source',
       	'colour':'rgb(255,220,220)'
        })
});

</script>

<style type="text/css">
.virtualsky_help { padding:10px;background-color:white;border-radius:0.5em;-moz-border-radius:0.5em;-webkit-border-radius:0.5em;} .virtualsky_help ul { list-style:none;margin:0px;padding:0px; } .virtualsky_infobox { background-color:#f0f0f0;color:black;padding:5px;border-radius:0.5em;-moz-border-radius:0.5em;-webkit-border-radius:0.5em;box-shadow:0px 0px 20px rgba(255,255,255,0.5);} .virtualsky_infobox img {} .virtualsky_infocredit {color:white;float:left;font-size:0.8em;padding:5px;position:absolute;} .virtualskyform { position:absolute;z-index:20;display:block;overflow:hidden;background-color:#ddd;padding:10px;box-shadow:0px 0px 20px rgba(255,255,255,0.5);border-radius:0.5em;-moz-border-radius:0.5em;-webkit-border-radius:0.5em; } .virtualsky_dismiss { float:right;padding: 0 5px 0 5px;margin:0px;font-weight:bold;cursor:pointer;color:black;margin-right:-5px;margin-top:-5px; } .virtualskyform input,.virtualskyform .divider { display:inline-block;font-size:1em;text-align:center;margin-right:2px; } .virtualskyform .divider { margin-top: 5px; padding: 2px;} .virtualsky_help_key:active{ background:#e9e9e9; } .virtualsky_help_key:hover{ border-color: #b0b0b0; } .virtualsky_help_key { cursor:pointer;display:inline-block;text-align:center;background:#f0f0f0;background:-moz-linear-gradient(top,#f0f0f0,#fcfcfc);background:-webkit-gradient(linear,center top,center bottom,from(#f0f0f0),to(#fcfcfc));border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;-webkit-background-clip:padding-box;-moz-background-clip:padding;background-clip:padding-box;color:#303030;border:1px solid #e0e0e0;border-bottom-width:2px;white-space:nowrap;font-family:monospace;padding:1px 6px;font-size:1.1em;}
</style>
</head>

<body>
<div id="starmap" style="width: 100%; height: 100%; margin: 0px auto; position: relative;">
<canvas id="starmap_inner" style="display: block; width: 383px; height: 764px; cursor: move;" width="383" height="764">
<div class="starmap_credit" style="padding: 0px; z-index: 20; display: block; overflow: hidden; background-color: transparent; position: absolute; top: 747px; left: 5px;">
<a href="http://lcogt.net/virtualsky" target="_parent" title="Las Cumbres Observatory Global Telescope" style="display: block; width: 100px; height: 12px; font-size: 12px;"></a>
</div>
<div class="starmap_clock" title="" style="position: absolute; padding: 0px; width: 137.256px; cursor: pointer; top: 5px; left: 5px; z-index: 20; display: block; overflow: hidden; background-color: transparent; font-size: 12px; color: transparent;">
</div>
<div class="starmap_position" title="" style="position: absolute; padding: 0px; width: 85.9922px; cursor: pointer; top: 17px; left: 5px; z-index: 20; font-size: 12px; display: block; overflow: hidden; background-color: transparent; color: transparent;">38.43, 79.94</div>
</div>
</body>
</html>
'''

sky = Template(html).safe_substitute(ra=RA.strip("\n"), dec=DEC.strip("\n"), source=SOURCE.strip("\n"))
print(sky)
